# Project conducted in Robotics Laboratory 3

A smart home was developed to enable convenient and practical living independently by using Atmega128.

It includes six functionalities, such as automatically opening doors, detecting room temperature to operate a fan,  
and adjusting the brightness and color of an LED lamp based on the surrounding environment.

Each operation processes sensor input by filtering and quantifying the values,  
enabling precise PWM actions corresponding to the respective sensor readings.

The actions implemented for each sensor are as follows:  

<img src="https://github.com/user-attachments/assets/f3569603-0330-40da-bb07-b9af23585e0e" alt="Description1" style="width: 50%; height: 500px;">
<hr style="border-top: 3px solid #bbb;">

## System Architecture & Sensors Used

<div style="display: flex; justify-content: space-around; align-items: center;">
  <img src="https://github.com/user-attachments/assets/6f0f1eaf-5175-4fff-8120-060f5205c805" alt="Description1" style="width: 40%; height: 250px; margin-right: 2%;">
  <img src="https://github.com/user-attachments/assets/0c07986e-1012-416b-9ced-7bc3740ee500" alt="Description" alt="Description2" style="width: 40%; height: 250px;">
</div>
<hr style="border-top: 3px solid #bbb;">

## Hardware Images

<div style="display: flex; justify-content: space-around; align-items: center;">
  <img src="https://github.com/user-attachments/assets/c7909233-b382-4147-bc1a-8802bd04d2ca" alt="Description1" style="width: 30%; height: 200px; margin-right: 2%;">
  <img src="https://github.com/user-attachments/assets/c0591b26-37f2-4f97-b80a-e8b3e7575715" alt="Description2" style="width: 30%; height: 200px;">
</div>

<img src="https://github.com/user-attachments/assets/e9cb752c-fcc2-489c-a148-d3ab53af9464" alt="Description1" style="width: 62%; height: 250px;">
<hr style="border-top: 3px solid #bbb;">

## circuit diagram

<div style="display: flex; justify-content: space-around;">
  <img src="https://github.com/user-attachments/assets/4d8ab495-3d44-472a-8ca2-7db1289ccecf" alt="Description1" style="width: 45%; height: 250px; margin-right: 2%;">
  <img src="https://github.com/user-attachments/assets/73936e29-3da8-41cb-9e17-55d9124fc7e4" alt="Description2" style="width: 45%; height: 250px; margin-right: 2%;">
</div>
<img src="https://github.com/user-attachments/assets/f8a9f11e-201d-4eac-870c-fdd188be039d" alt="Description2" style="width: 45%; height: 250px;">
<hr style="border-top: 3px solid #bbb;">

## Sensor Value Filtering

Used 6 Sensors : Potentiometor, Cds Sensor, Thermistor, PSD sensor, Sound sensor, Rain Detection Sensor  
In Graph, * red-LPF/FIR, blue-MAF/IIR *

1) Potentiometor -> apply "LPF RC filter"  
The noise generated by the sensors was minimal enough not to affect the operation of the actuators.  
Therefore, considering the computational load of the control loop in the code, the simplest RC filter was used.

<div style="display: flex; justify-content: space-around;">
  <img src="https://github.com/user-attachments/assets/6880ad8f-a5ef-4ff4-a84a-2b72ef5e1f12" alt="Description1" style="width: 35%; height: 200px; margin-right: 2%;">
  <img src="https://github.com/user-attachments/assets/1d0d605c-8416-4022-80fb-b39ae514cc4c" alt="Description2" style="width: 35%; height: 200px; margin-right: 2%;">
</div>



2) Cds sensor -> apply "2nd-Order IIR LPF Filter, Cutoff Frequency = 0.2"  
To effectively suppress noise and minimize the influence of temporary changes while producing smooth and gradual value variations,  
a low cutoff frequency was set, and a 2nd-order IIR LPF was chosen.

<div style="display: flex; justify-content: space-around;">
  <img src="https://github.com/user-attachments/assets/daf04a3d-8a6d-4452-82f9-c67c66098e84" alt="Description1" style="width: 35%; height: 200px; margin-right: 2%;">
  <img src="https://github.com/user-attachments/assets/74ecd5cd-4371-44d2-9c7b-50c9a96ab55b" alt="Description2" style="width: 35%; height: 200px; margin-right: 2%;">
</div>



3) Thermistor -> apply "MAF (Average of 10 Data Points)"  
For the thermistor sensor, the ADC values received via UART revealed that the resistance change was very small,  
confirming that the sensor's inherent noise was minimal. Since the performance difference between filters was negligible,  
a relatively simple Moving Average Filter (MAF) was chosen, considering the computational load of the control loop.

<div style="display: flex; justify-content: space-around;">
  <img src="https://github.com/user-attachments/assets/301039ba-ca57-480a-adf9-f8892b53103e" alt="Description1" style="width: 35%; height: 200px; margin-right: 2%;">
  <img src="https://github.com/user-attachments/assets/9547767f-178a-45c5-a740-d8dabdb2a4a8" alt="Description2" style="width: 35%; height: 200px; margin-right: 2%;">
</div>



4) PSD sensor -> apply "2nd-Order IIR LPF Filter, Cutoff Frequency = 3"  
By receiving the ADC values of the PSD sensor via UART and analyzing them through a graph,  
it was observed that due to the fast response characteristics of the component, significant periodic noise occurred momentarily.  
Therefore, to effectively eliminate these transient small noises, a 2nd-order IIR LPF with a feedback structure was employed,  
where the input and output signal values are recursively applied for filtering.

<div style="display: flex; justify-content: space-around;">
  <img src="https://github.com/user-attachments/assets/eb330765-76a2-449c-8851-fe81db8104e7" alt="Description1" style="width: 35%; height: 200px; margin-right: 2%;">
  <img src="https://github.com/user-attachments/assets/659ce08f-7cfd-4e4a-afee-0238f8e18cd7" alt="Description2" style="width: 35%; height: 200px; margin-right: 2%;">
</div>



5) Sound sensor -> apply "30th-Order FIR LPF Filter, Cutoff Frequency = 3"  
For the sound sensor, which generates the most significant noise, a highly effective noise reduction filter was required to obtain accurate values.  
Since the filtering performance improves as the order of the FIR filter increases, a 30th-order FIR LPF filter was designed and applied.

<div style="display: flex; justify-content: space-around;">
  <img src="https://github.com/user-attachments/assets/1e1dda14-eb18-4e5f-8391-64ac6eeb2a2d" alt="Description1" style="width: 35%; height: 200px; margin-right: 2%;">
  <img src="https://github.com/user-attachments/assets/34689bd5-278f-4475-b311-472a6f8e5b1e" alt="Description2" style="width: 35%; height: 200px; margin-right: 2%;">
</div>



6) Rain Detection Sensor -> apply "10th-Order FIR LPF Filter, Cutoff Frequency = 2"  
An open-loop FIR LPF filter was used, designed to preserve the waveform shape between the input and output to a reasonable extent.  
When configured as a 10th-order filter, it achieved the desired level of filtering effectively, leading to the selection of the 10th-order FIR LPF filter.

<div style="display: flex; justify-content: space-around;">
  <img src="https://github.com/user-attachments/assets/8f40f95e-4f44-4391-b60c-070550cb3d38" alt="Description1" style="width: 35%; height: 200px; margin-right: 2%;">
  <img src="https://github.com/user-attachments/assets/029f1775-6fa4-4e2e-ad63-68fa8c05fe5f" alt="Description2" style="width: 35%; height: 200px; margin-right: 2%;">
</div>


## Problems Encountered During the Project

The control cycle of the overall periodic control timer was set to 10ms for sampling. However, when receiving the values via UART0 communication and checking the log files,  
there were slight discrepancies between the number of samples and the elapsed time. This was assumed to be due to the limitations of processing speed in the code and the communication speed.

Additionally, issues such as missing or fluctuating sensor values were resolved by referring to the Atmega128 datasheet to adjust pin configurations and debugging through UART0 communication,  
making incremental modifications to the code.





